<!DOCTYPE html>
<html>
<head>
    <title>Story Ark Map</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

    <style>
        #map {
            height: 90vh;
            width: 100%;
        }
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
        }
        h2 {
            font-family: 'Lora', serif;
            text-align: center;
            padding: 8px;
        }
        h4 {
            font-family: 'Lora', serif;
            text-align: center;
            margin-top: -10px;
            color: #555;
            font-weight: normal;
        }

        .legend-box {
            font-family: 'Lora', serif;
            background: #F5F5F5;
            padding: 10px;
            line-height: 1.5em;
            color: #333;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
            position: absolute;
            bottom: 80px;
            left: 10px;
            z-index: 1000;
            font-size: 14px;
        }

        .legend-box h4 {
            margin: 0 0 5px;
        }

        .legend-box span {
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-right: 6px;
            border: 1px solid #555;
        }

        .interview-legend {
            font-family: 'Lora', serif;
            background: #F5F5F5;
            padding: 8px;
            line-height: 1.5em;
            color: #333;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
            position: absolute;
            bottom: 30px;
            left: 10px;
            z-index: 1000;
            font-size: 14px;
        }

        .star-legend {
            color: black;
            font-size: 16px;
            display: inline;
        }

        footer {
            text-align: center;
            padding: 10px;
            color: #777;
            font-size: 13px;
            font-family: 'Lora', serif;
        }

        footer a {
            color: #777;
            text-decoration: underline;
        }

        footer a:hover {
            color: #5F9E8F;
        }

        #logo {
            position: fixed;
            bottom: 10px;
            right: 10px;
            width: 120px;
            height: auto;
            z-index: 1100;
            opacity: 0.85;
            transition: opacity 0.3s ease;
            cursor: pointer;
        }

        #logo:hover {
            opacity: 1;
        }

        .custom-star-icon {
            color: black;
            font-size: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

<h2>Story Ark</h2>
<p style="text-align:center; font-size:18px; color:gray;">
    Tales from southern Africa’s climate tipping points: click on the icons to reveal the stories!
</p>

<div id="map"></div>

<!-- Stories Legend -->
<div class="legend-box">
    <h4>Chapters</h4>
    <p><span style="background-color: #D33A03;"></span> Dust Bowl</p>
    <p><span style="background-color: #FED219;"></span> Golden Threads</p>
    <p><span style="background-color: #000000;"></span> Oil Spill</p>
    <p><span style="background-color: #277EC3;"></span> We, the people</p>
</div>

<!-- Interviews Legend -->
<div class="interview-legend">
    <p><span class="star-legend">★</span> On the air</p>
</div>

<a href="https://www.storyark.co.za/" target="_blank">
    <img src="logo.png" alt="Logo" id="logo" />
</a>

<footer>
    Made by <a href="https://www.linkedin.com/in/skylathornton/" target="_blank">Skyla Thornton</a>, 
    <a href="https://climate.sun.ac.za/" target="_blank">School for Climate Studies</a>.
</footer>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    const map = L.map('map', {
        center: [-30.5595, 22.9375],
        zoom: 6,
        minZoom: 5,
        maxZoom: 10,
        maxBounds: [
            [-37, 10],
            [-20, 35]
        ],
        maxBoundsViscosity: 0.8
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; OpenStreetMap & CartoDB',
        maxZoom: 19
    }).addTo(map);

    function getColor(group) {
        const colors = {
            Red: '#D33A03',
            Yellow: '#FED219',
            Black: '#000000',
            Blue: '#277EC3'
        };
        return colors[group] || '#999';
    }

    // Story locations
    const locations = [
        {lat: -31.37952, lon: 19.10548, group: 'Red', link: 'https://news.mongabay.com/2024/12/poachers-target-south-africas-miracle-plant-with-near-impunity/', title: 'Poachers target SA’s ‘miracle’ plant with impunity, Mongabay, (20/12/2024)'},
        {lat: -28.398375, lon: 16.784979, group: 'Red', link: 'https://www.dailymaverick.co.za/article/2025-01-28-karoo-dust-bowl-part-i-here-come-the-dunes/', title: 'Karoo Dust Bowl [Part 1]: Here come the dunes, Daily Maverick, (28/01/2025)'},
        // ... add the rest
    ];

    locations.forEach(loc => {
        const marker = L.circleMarker([loc.lat, loc.lon], {
            radius: 8,
            fillColor: getColor(loc.group),
            color: "#000",
            weight: 1,
            opacity: 1,
            fillOpacity: 0.8
        }).addTo(map);

        marker.bindPopup(`<a href="${loc.link}" target="_blank">${loc.title}</a>`);
    });

    // Interviews
    const interviews = [
        {lat: -33.933331, lon: 18.465116, link: 'https://www.storyark.co.za/inthepress/blog-post-title-one-es56n', title: 'Cape Talk: Leonie announces the approaching launch of the project...'},
        {lat: -29.219558, lon: 17.463318, link: 'https://www.storyark.co.za/inthepress/blog-post-title-one-es56n-jjc2c', title: 'Cape Talk: Leonie discusses the approaching launch of the project...'},
        // ... add the rest
    ];

    interviews.forEach(interview => {
        const starMarker = L.marker([interview.lat, interview.lon], {
            icon: L.divIcon({
                className: 'custom-star-icon',
                html: '★',
                iconSize: [20, 20],
                iconAnchor: [10, 10]
            })
        }).addTo(map);

        starMarker.bindPopup(`<a href="${interview.link}" target="_blank">${interview.title}</a>`);
    });
</script>

</body>
</html>


